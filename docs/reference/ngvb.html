<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Finds the posterior distribution of the hyperparameters \(\boldsymbol{\theta}\), latent field \(\mathbf{x}\),
mixing variables \(\mathbf{V}\), and non-Gaussianity parameters \(\eta\) of latent non-Gaussian models (LnGMs)
using INLA and variational Bayes approximations. These LnGMs are flexible extensions
of latent Gaussian models (LGMs). The LnGMs are specified either through
an INLA object (fit) that fits an LGM or through a list of configurations (manual.configs).
Run `devtools::build_vignettes("ngvb")` and `vignette("ngvb")` to see several use cases.'><title>Approximate inference of latent non-Gaussian models (LnGMs) — ngvb • ngvb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Approximate inference of latent non-Gaussian models (LnGMs) — ngvb"><meta property="og:description" content='Finds the posterior distribution of the hyperparameters \(\boldsymbol{\theta}\), latent field \(\mathbf{x}\),
mixing variables \(\mathbf{V}\), and non-Gaussianity parameters \(\eta\) of latent non-Gaussian models (LnGMs)
using INLA and variational Bayes approximations. These LnGMs are flexible extensions
of latent Gaussian models (LGMs). The LnGMs are specified either through
an INLA object (fit) that fits an LGM or through a list of configurations (manual.configs).
Run `devtools::build_vignettes("ngvb")` and `vignette("ngvb")` to see several use cases.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ngvb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ngvb.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Approximate inference of latent non-Gaussian models (LnGMs)</h1>
      
      <div class="d-none name"><code>ngvb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Finds the posterior distribution of the hyperparameters \(\boldsymbol{\theta}\), latent field \(\mathbf{x}\),
mixing variables \(\mathbf{V}\), and non-Gaussianity parameters \(\eta\) of latent non-Gaussian models (LnGMs)
using INLA and variational Bayes approximations. These LnGMs are flexible extensions
of latent Gaussian models (LGMs). The LnGMs are specified either through
an INLA object (<code>fit</code>) that fits an LGM or through a list of configurations (<code>manual.configs</code>).
Run `devtools::build_vignettes("ngvb")` and `vignette("ngvb")` to see several use cases.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ngvb</span><span class="op">(</span></span>
<span>  fit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  manual.configs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selection <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha.eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selection</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  n.sampling <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  d.sampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"SCVI"</span>,</span>
<span>  fast <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  history <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  V.init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta.init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  stop.rel.change <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>fit</dt>
<dd><p>The inla object that fits the LGM.</p></dd>


<dt>manual.configs</dt>
<dd><p>Not necessary if <code>fit</code> is provided. List containing:</p><ul><li><p><code>inla.fit.V</code> Function that receives as input the mixing variables \(\mathbf{V}\) and
   the output is an inla object that fits the LGM \((\mathbf{x},\boldsymbol{\theta} | \mathbf{V}, \mathbf{y})\).</p></li>
<li><p><code>Dfunc</code> Function that receives as input the hyperparameter vector \(\boldsymbol{\theta}\)
    in internal scale and the output is \(\mathbf{D}(\boldsymbol{\theta})\), where \(\mathbf{D}\) is the dependency matrix that
    specifies the non-Gaussian latent field. If there is more than one latent component
    to be extended to non-Gaussianity, this should be a list of functions \(\mathbf{D}_i(\boldsymbol{\theta})\),
    where \(\mathbf{D}_i(\boldsymbol{\theta})\) is the dependency matrix that specifies component i.</p></li>
<li><p><code>h</code> Predefined constant \(\mathbf{h}\) vector that contains the distance between locations
    or area of the basis functions. For models defined in discrete space this should be a
    vector of ones. If there is more than one latent component to be extended to non-Gaussianity,
    this should be a list of vectors \(\mathbf{h_i}\)
    where \(\mathbf{h_i}\) is the predefined constant vector of component i.</p></li>
</ul></dd>


<dt>selection</dt>
<dd><p>List which specifies which model components of the LGM are to be extended
to non-Gaussianity. Same syntax as the argument <code>selection</code> of
the function <code>inla.posterior.sample</code>.</p></dd>


<dt>alpha.eta</dt>
<dd><p>Numeric. Rate parameter of the exponential prior of the non-Gaussianity parameter \(\alpha\).
Should be a vector with the same dimension as the number of model components to extend.</p></dd>


<dt>n.sampling</dt>
<dd><p>Numeric. Number of samples uses in several sampling task throughout the SVI or SCVI algorithm.</p></dd>


<dt>d.sampling</dt>
<dd><p>Logical. If <code>TRUE</code> the expectations \(d_i = E([\mathbf{D}\mathbf{x}]_i^2)\) are computed
by sampling (slower). If <code>FALSE</code> (default) uses the mixture Gaussian approximation
of \(\mathbf{x}\) obtained in INLA.</p></dd>


<dt>method</dt>
<dd><p>Character. Should be <code>"SCVI"</code>, <code>"SVI"</code>, or <code>"Gibbs"</code> if the algorithm
should be the structural and collapsed variational inference algorithm (faster) or the structural
variational inference algorithm (slower), or a Gibbs sampler (even slower), respectively.</p></dd>


<dt>fast</dt>
<dd><p>Logical. If <code>TRUE</code> then INLA will be run with the empirical Bayes mode and
several control variables will be turned off to improve the speed of the algorithm.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. If <code>TRUE</code> print the posterior mean of \(\eta\) and plot the posterior
mean of \(\mathbf{V}\) at each iteration.</p></dd>


<dt>history</dt>
<dd><p>Logical. If <code>TRUE</code> save LGM inla object of each iteration. If <code>FALSE</code> only
save the LGM inla object of the last iteration.</p></dd>


<dt>V.init</dt>
<dd><p>List of numeric vectors. Initial values for \(\mathbf{V}\). By default \(\mathbf{V}=\mathbf{h}\).</p></dd>


<dt>eta.init</dt>
<dd><p>Numeric vector. Initial values of \(\eta\). By default eta.init = 0.5.</p></dd>


<dt>iter</dt>
<dd><p>Integer. Maximum number of iterations.</p></dd>


<dt>stop.rel.change</dt>
<dd><p>Numeric. Stop the algorithm when the relative change in the posterior mean
of \(\eta\) is smaller than <code>stop.rel.change</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An S4 object containing the outputs. Slots are accessed with @. These are:</p><ul><li><p><code>history</code> List containing summaries and inla objects (if <code>history = TRUE</code>) of each iteration (except the last one).</p></li>
<li><p><code>LGM</code> inla object containing summaries and marginals of the latent field \(\mathbf{x}\)
   and hyperparameters \(\boldsymbol{\theta}\) of the last iteration.</p></li>
<li><p><code>summary.mixing</code> Data frame containing summaries of the mixing variables \(\mathbf{V}\).</p></li>
<li><p><code>summary.ng</code> Data frame containing summaries of the non-Gaussianiy parameters \(\eta\).</p></li>
<li><p><code>configs</code> List containing the LnGM model specifications</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="co">#Here we fit an RW1 latent process to the jumpts time series</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">jumpts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#Fit LGM with INLA</span></span></span>
<span class="r-in"><span> <span class="va">LGM</span>     <span class="op">&lt;-</span> <span class="fu">inla</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span>,  model <span class="op">=</span> <span class="st">"rw1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">jumpts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#Fit LnGM with ngvb</span></span></span>
<span class="r-in"><span> <span class="va">LnGM</span> <span class="op">&lt;-</span> <span class="fu">ngvb</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">LGM</span>, selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#Available methods</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">LnGM</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">LnGM</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LnGM</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">LnGM</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">LnGM</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rafael Cabral.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

